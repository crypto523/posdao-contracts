---
id: BlockRewardAuRa
title: BlockRewardAuRa
---

<div class="contract-doc"><div class="contract"><h2 class="contract-header"><span class="contract-kind">contract</span> BlockRewardAuRa</h2><p class="base-contracts"><span>is</span> <a href="abstracts_BlockRewardBase.html">BlockRewardBase</a></p><p class="description">Generates and distributes rewards according to the logic and formulas described in the white paper.</p><div class="source">Source: <a href="https://github.com/poanetwork/posdao-contracts/blob/v0.1.0/contracts/BlockRewardAuRa.sol" target="_blank">contracts/BlockRewardAuRa.sol</a></div></div><div class="index"><h2>Index</h2><ul><li><a href="BlockRewardAuRa.html#_dequeueValidator">_dequeueValidator</a></li><li><a href="BlockRewardAuRa.html#_distributeRewards">_distributeRewards</a></li><li><a href="BlockRewardAuRa.html#_enqueueValidator">_enqueueValidator</a></li><li><a href="BlockRewardAuRa.html#_rewardPointBlock">_rewardPointBlock</a></li><li><a href="BlockRewardAuRa.html#_subNativeRewardUndistributed">_subNativeRewardUndistributed</a></li><li><a href="BlockRewardAuRa.html#_subTokenRewardUndistributed">_subTokenRewardUndistributed</a></li><li><a href="BlockRewardAuRa.html#_validatorsQueueSize">_validatorsQueueSize</a></li><li><a href="BlockRewardAuRa.html#getBlocksCreated">getBlocksCreated</a></li><li><a href="BlockRewardAuRa.html#getEpochPoolNativeReward">getEpochPoolNativeReward</a></li><li><a href="BlockRewardAuRa.html#getEpochPoolTokenReward">getEpochPoolTokenReward</a></li><li><a href="BlockRewardAuRa.html#getNativeRewardUndistributed">getNativeRewardUndistributed</a></li><li><a href="BlockRewardAuRa.html#getTokenRewardUndistributed">getTokenRewardUndistributed</a></li><li><a href="BlockRewardAuRa.html#reward">reward</a></li></ul></div><div class="reference"><h2>Reference</h2><div class="functions"><h3>Functions</h3><ul><li><div class="item function"><span id="_dequeueValidator" class="anchor-marker"></span><h4 class="name">_dequeueValidator</h4><div class="body"><code class="signature">function <strong>_dequeueValidator</strong><span>() </span><span>internal </span><span>returns  (address) </span></code><hr/><div class="description"><p>Dequeues a validator enqueued for the snapshotting or rewarding process. Used by the `reward` and `_distributeRewards` functions. If the queue is empty, the function returns a zero address.</p></div><dl><dt><span class="label-return">Returns:</span></dt><dd>address</dd></dl></div></div></li><li><div class="item function"><span id="_distributeRewards" class="anchor-marker"></span><h4 class="name">_distributeRewards</h4><div class="body"><code class="signature">function <strong>_distributeRewards</strong><span>(IValidatorSet _validatorSetContract, address _erc20TokenContract, IStakingAuRa _stakingContract, uint256 _stakingEpoch, uint256 _rewardPointBlock) </span><span>internal </span><span>returns  (address[], uint256[], bool) </span></code><hr/><div class="description"><p>Distributes rewards among participants during the last MAX_VALIDATORS * DELEGATORS_ALIQUOT blocks of a staking epoch. This function is called by the `reward` function.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_validatorSetContract</code> - The address of the ValidatorSet contract.</div><div><code>_erc20TokenContract</code> - The address of the ERC20 staking token contract.</div><div><code>_stakingContract</code> - The address of the Staking contract.</div><div><code>_stakingEpoch</code> - The number of the current staking epoch.</div><div><code>_rewardPointBlock</code> - The number of the block within the current staking epoch when the rewarding process should start. This number is calculated by the `_rewardPointBlock` getter.</div></dd><dt><span class="label-return">Returns:</span></dt><dd>noop The boolean flag which is set to `true` when there are no complex operations during the function launch. The flag is used by the `reward` function to control the load on the block inside the `_mintNativeCoinsByErcToNativeBridge` function.</dd></dl></div></div></li><li><div class="item function"><span id="_enqueueValidator" class="anchor-marker"></span><h4 class="name">_enqueueValidator</h4><div class="body"><code class="signature">function <strong>_enqueueValidator</strong><span>(address _validatorStakingAddress) </span><span>internal </span></code><hr/><div class="description"><p>Enqueues the specified validator for the snapshotting or rewarding process. Used by the `reward` and `_distributeRewards` functions. See also DELEGATORS_ALIQUOT.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_validatorStakingAddress</code> - The staking address of a validator to be enqueued.</div></dd></dl></div></div></li><li><div class="item function"><span id="_rewardPointBlock" class="anchor-marker"></span><h4 class="name">_rewardPointBlock</h4><div class="body"><code class="signature">function <strong>_rewardPointBlock</strong><span>(IStakingAuRa _stakingContract, IValidatorSet _validatorSetContract) </span><span>internal </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Calculates the starting block number for the rewarding process at the end of the current staking epoch. Used by the `reward` and `_distributeRewards` functions.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_stakingContract</code> - The address of the StakingAuRa contract.</div><div><code>_validatorSetContract</code> - The address of the ValidatorSet contract.</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint256</dd></dl></div></div></li><li><div class="item function"><span id="_subNativeRewardUndistributed" class="anchor-marker"></span><h4 class="name">_subNativeRewardUndistributed</h4><div class="body"><code class="signature">function <strong>_subNativeRewardUndistributed</strong><span>(uint256 _minus) </span><span>internal </span></code><hr/><div class="description"><p>Reduces an undistributed amount of native coins. This function is used by the `_distributeRewards` function.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_minus</code> - The subtraction value.</div></dd></dl></div></div></li><li><div class="item function"><span id="_subTokenRewardUndistributed" class="anchor-marker"></span><h4 class="name">_subTokenRewardUndistributed</h4><div class="body"><code class="signature">function <strong>_subTokenRewardUndistributed</strong><span>(uint256 _minus) </span><span>internal </span></code><hr/><div class="description"><p>Reduces an undistributed amount of staking tokens. This function is used by the `_distributeRewards` function.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_minus</code> - The subtraction value.</div></dd></dl></div></div></li><li><div class="item function"><span id="_validatorsQueueSize" class="anchor-marker"></span><h4 class="name">_validatorsQueueSize</h4><div class="body"><code class="signature">function <strong>_validatorsQueueSize</strong><span>() </span><span>internal </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the size of the validator queue used for the snapshotting and rewarding processes. See `_enqueueValidator` and `_dequeueValidator` functions. This function is used by the `reward` and `_distributeRewards` functions.</p></div><dl><dt><span class="label-return">Returns:</span></dt><dd>uint256</dd></dl></div></div></li><li><div class="item function"><span id="getBlocksCreated" class="anchor-marker"></span><h4 class="name">getBlocksCreated</h4><div class="body"><code class="signature">function <strong>getBlocksCreated</strong><span>(uint256 _stakingEpoch, address _validatorMiningAddress) </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns a number of blocks produced by the specified validator during the specified staking epoch (beginning from the block when the `finalizeChange` function is called until the block specified by the `_rewardPointBlock` function). The results are used by the `_distributeRewards` function to track each validator&#x27;s downtime (when a validator&#x27;s node is not running and doesn&#x27;t produce blocks).</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_stakingEpoch</code> - The number of the staking epoch for which the statistics should be returned.</div><div><code>_validatorMiningAddress</code> - The mining address of the validator for which the statistics should be returned.</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint256</dd></dl></div></div></li><li><div class="item function"><span id="getEpochPoolNativeReward" class="anchor-marker"></span><h4 class="name">getEpochPoolNativeReward</h4><div class="body"><code class="signature">function <strong>getEpochPoolNativeReward</strong><span>(uint256 _stakingEpoch, address _poolStakingAddress) </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the reward amount to be distributed in native coins among participants (the validator and their delegators) of the specified pool at the end of the specified staking epoch.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_stakingEpoch</code> - The number of the staking epoch for which the amount should be returned.</div><div><code>_poolStakingAddress</code> - The staking address of the pool for which the amount should be returned.</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint256</dd></dl></div></div></li><li><div class="item function"><span id="getEpochPoolTokenReward" class="anchor-marker"></span><h4 class="name">getEpochPoolTokenReward</h4><div class="body"><code class="signature">function <strong>getEpochPoolTokenReward</strong><span>(uint256 _stakingEpoch, address _poolStakingAddress) </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the reward amount to be distributed in staking tokens among participants (the validator and their delegators) of the specified pool at the end of the specified staking epoch.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_stakingEpoch</code> - The number of the staking epoch for which the amount should be returned.</div><div><code>_poolStakingAddress</code> - The staking address of the pool for which the amount should be returned.</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint256</dd></dl></div></div></li><li><div class="item function"><span id="getNativeRewardUndistributed" class="anchor-marker"></span><h4 class="name">getNativeRewardUndistributed</h4><div class="body"><code class="signature">function <strong>getNativeRewardUndistributed</strong><span>() </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the total reward amount in native coins which is not yet distributed among participants.</p></div><dl><dt><span class="label-return">Returns:</span></dt><dd>uint256</dd></dl></div></div></li><li><div class="item function"><span id="getTokenRewardUndistributed" class="anchor-marker"></span><h4 class="name">getTokenRewardUndistributed</h4><div class="body"><code class="signature">function <strong>getTokenRewardUndistributed</strong><span>() </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the total reward amount in staking tokens which is not yet distributed among participants.</p></div><dl><dt><span class="label-return">Returns:</span></dt><dd>uint256</dd></dl></div></div></li><li><div class="item function"><span id="reward" class="anchor-marker"></span><h4 class="name">reward</h4><div class="body"><code class="signature">function <strong>reward</strong><span>(address[] benefactors, uint16[] kind) </span><span>external </span><span>returns  (address[], uint256[]) </span></code><hr/><div class="description"><p>Called by the validator&#x27;s node when producing and closing a block, see https://wiki.parity.io/Block-Reward-Contract.html. This function performs all of the automatic operations needed for controlling secrets revealing by validators, accumulating block producing statistics, starting a new staking epoch, snapshotting reward coefficients at the beginning of a new staking epoch, rewards distributing at the end of a staking epoch, and minting native coins needed for the `erc-to-native` bridge.</p></div><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="abstracts_BlockRewardBase.html#onlySystem">onlySystem </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>benefactors</code> - address[]</div><div><code>kind</code> - uint16[]</div></dd><dt><span class="label-return">Returns:</span></dt><dd>address[]</dd><dd>uint256[]</dd></dl></div></div></li></ul></div></div></div>
