---
id: abstracts_StakingBase
title: StakingBase
---

<div class="contract-doc"><div class="contract"><h2 class="contract-header"><span class="contract-kind">contract</span> StakingBase</h2><p class="base-contracts"><span>is</span> <a href="eternal-storage_OwnedEternalStorage.html">OwnedEternalStorage</a><span>, </span><a href="interfaces_IStaking.html">IStaking</a></p><p class="description">The base contract for the StakingAuRa and StakingHBBFT contracts.</p><div class="source">Source: <a href="https://github.com/poanetwork/posdao-contracts/blob/v0.1.0/contracts/abstracts/StakingBase.sol" target="_blank">contracts/abstracts/StakingBase.sol</a></div></div><div class="index"><h2>Index</h2><ul><li><a href="abstracts_StakingBase.html#Claimed">Claimed</a></li><li><a href="abstracts_StakingBase.html#StakeMoved">StakeMoved</a></li><li><a href="abstracts_StakingBase.html#Staked">Staked</a></li><li><a href="abstracts_StakingBase.html#WithdrawalOrdered">WithdrawalOrdered</a></li><li><a href="abstracts_StakingBase.html#Withdrawn">Withdrawn</a></li><li><a href="abstracts_StakingBase.html#_addPoolActive">_addPoolActive</a></li><li><a href="abstracts_StakingBase.html#_addPoolDelegator">_addPoolDelegator</a></li><li><a href="abstracts_StakingBase.html#_addPoolDelegatorInactive">_addPoolDelegatorInactive</a></li><li><a href="abstracts_StakingBase.html#_addPoolInactive">_addPoolInactive</a></li><li><a href="abstracts_StakingBase.html#_addPoolToBeElected">_addPoolToBeElected</a></li><li><a href="abstracts_StakingBase.html#_addPoolToBeRemoved">_addPoolToBeRemoved</a></li><li><a href="abstracts_StakingBase.html#_deletePoolToBeElected">_deletePoolToBeElected</a></li><li><a href="abstracts_StakingBase.html#_deletePoolToBeRemoved">_deletePoolToBeRemoved</a></li><li><a href="abstracts_StakingBase.html#_getCurrentBlockNumber">_getCurrentBlockNumber</a></li><li><a href="abstracts_StakingBase.html#_getMaxCandidates">_getMaxCandidates</a></li><li><a href="abstracts_StakingBase.html#_initialize">_initialize</a></li><li><a href="abstracts_StakingBase.html#_isPoolToBeElected">_isPoolToBeElected</a></li><li><a href="abstracts_StakingBase.html#_isWithdrawAllowed">_isWithdrawAllowed</a></li><li><a href="abstracts_StakingBase.html#_removePool">_removePool</a></li><li><a href="abstracts_StakingBase.html#_removePoolDelegator">_removePoolDelegator</a></li><li><a href="abstracts_StakingBase.html#_removePoolDelegatorInactive">_removePoolDelegatorInactive</a></li><li><a href="abstracts_StakingBase.html#_removePoolInactive">_removePoolInactive</a></li><li><a href="abstracts_StakingBase.html#_setCandidateMinStake">_setCandidateMinStake</a></li><li><a href="abstracts_StakingBase.html#_setDelegatorMinStake">_setDelegatorMinStake</a></li><li><a href="abstracts_StakingBase.html#_setLikelihood">_setLikelihood</a></li><li><a href="abstracts_StakingBase.html#_setOrderWithdrawEpoch">_setOrderWithdrawEpoch</a></li><li><a href="abstracts_StakingBase.html#_setOrderedWithdrawAmount">_setOrderedWithdrawAmount</a></li><li><a href="abstracts_StakingBase.html#_setOrderedWithdrawAmountTotal">_setOrderedWithdrawAmountTotal</a></li><li><a href="abstracts_StakingBase.html#_setPoolDelegatorInactiveIndex">_setPoolDelegatorInactiveIndex</a></li><li><a href="abstracts_StakingBase.html#_setPoolDelegatorIndex">_setPoolDelegatorIndex</a></li><li><a href="abstracts_StakingBase.html#_setPoolInactiveIndex">_setPoolInactiveIndex</a></li><li><a href="abstracts_StakingBase.html#_setPoolIndex">_setPoolIndex</a></li><li><a href="abstracts_StakingBase.html#_setPoolToBeElectedIndex">_setPoolToBeElectedIndex</a></li><li><a href="abstracts_StakingBase.html#_setPoolToBeRemovedIndex">_setPoolToBeRemovedIndex</a></li><li><a href="abstracts_StakingBase.html#_setStakeAmount">_setStakeAmount</a></li><li><a href="abstracts_StakingBase.html#_setStakeAmountByCurrentEpoch">_setStakeAmountByCurrentEpoch</a></li><li><a href="abstracts_StakingBase.html#_setStakeAmountTotal">_setStakeAmountTotal</a></li><li><a href="abstracts_StakingBase.html#_stake">_stake</a></li><li><a href="abstracts_StakingBase.html#_stake">_stake</a></li><li><a href="abstracts_StakingBase.html#_withdraw">_withdraw</a></li><li><a href="abstracts_StakingBase.html#_withdrawCheckPool">_withdrawCheckPool</a></li><li><a href="abstracts_StakingBase.html#areStakeAndWithdrawAllowed">areStakeAndWithdrawAllowed</a></li><li><a href="abstracts_StakingBase.html#claimOrderedWithdraw">claimOrderedWithdraw</a></li><li><a href="abstracts_StakingBase.html#clearUnremovableValidator">clearUnremovableValidator</a></li><li><a href="abstracts_StakingBase.html#erc20TokenContract">erc20TokenContract</a></li><li><a href="abstracts_StakingBase.html#gasPriceIsValid">gasPriceIsValid</a></li><li><a href="abstracts_StakingBase.html#getCandidateMinStake">getCandidateMinStake</a></li><li><a href="abstracts_StakingBase.html#getDelegatorMinStake">getDelegatorMinStake</a></li><li><a href="abstracts_StakingBase.html#getPools">getPools</a></li><li><a href="abstracts_StakingBase.html#getPoolsInactive">getPoolsInactive</a></li><li><a href="abstracts_StakingBase.html#getPoolsLikelihood">getPoolsLikelihood</a></li><li><a href="abstracts_StakingBase.html#getPoolsToBeElected">getPoolsToBeElected</a></li><li><a href="abstracts_StakingBase.html#getPoolsToBeRemoved">getPoolsToBeRemoved</a></li><li><a href="abstracts_StakingBase.html#incrementStakingEpoch">incrementStakingEpoch</a></li><li><a href="abstracts_StakingBase.html#isPoolActive">isPoolActive</a></li><li><a href="abstracts_StakingBase.html#maxWithdrawAllowed">maxWithdrawAllowed</a></li><li><a href="abstracts_StakingBase.html#maxWithdrawOrderAllowed">maxWithdrawOrderAllowed</a></li><li><a href="abstracts_StakingBase.html#moveStake">moveStake</a></li><li><a href="abstracts_StakingBase.html#onTokenTransfer">onTokenTransfer</a></li><li><a href="abstracts_StakingBase.html#onlyBlockRewardContract">onlyBlockRewardContract</a></li><li><a href="abstracts_StakingBase.html#onlyValidatorSetContract">onlyValidatorSetContract</a></li><li><a href="abstracts_StakingBase.html#orderWithdraw">orderWithdraw</a></li><li><a href="abstracts_StakingBase.html#orderWithdrawEpoch">orderWithdrawEpoch</a></li><li><a href="abstracts_StakingBase.html#orderedWithdrawAmount">orderedWithdrawAmount</a></li><li><a href="abstracts_StakingBase.html#orderedWithdrawAmountTotal">orderedWithdrawAmountTotal</a></li><li><a href="abstracts_StakingBase.html#poolDelegatorInactiveIndex">poolDelegatorInactiveIndex</a></li><li><a href="abstracts_StakingBase.html#poolDelegatorIndex">poolDelegatorIndex</a></li><li><a href="abstracts_StakingBase.html#poolDelegators">poolDelegators</a></li><li><a href="abstracts_StakingBase.html#poolInactiveIndex">poolInactiveIndex</a></li><li><a href="abstracts_StakingBase.html#poolIndex">poolIndex</a></li><li><a href="abstracts_StakingBase.html#poolToBeElectedIndex">poolToBeElectedIndex</a></li><li><a href="abstracts_StakingBase.html#poolToBeRemovedIndex">poolToBeRemovedIndex</a></li><li><a href="abstracts_StakingBase.html#removePool">removePool</a></li><li><a href="abstracts_StakingBase.html#removePool">removePool</a></li><li><a href="abstracts_StakingBase.html#setCandidateMinStake">setCandidateMinStake</a></li><li><a href="abstracts_StakingBase.html#setDelegatorMinStake">setDelegatorMinStake</a></li><li><a href="abstracts_StakingBase.html#setErc20TokenContract">setErc20TokenContract</a></li><li><a href="abstracts_StakingBase.html#stake">stake</a></li><li><a href="abstracts_StakingBase.html#stakeAmount">stakeAmount</a></li><li><a href="abstracts_StakingBase.html#stakeAmountByCurrentEpoch">stakeAmountByCurrentEpoch</a></li><li><a href="abstracts_StakingBase.html#stakeAmountMinusOrderedWithdraw">stakeAmountMinusOrderedWithdraw</a></li><li><a href="abstracts_StakingBase.html#stakeAmountTotal">stakeAmountTotal</a></li><li><a href="abstracts_StakingBase.html#stakeAmountTotalMinusOrderedWithdraw">stakeAmountTotalMinusOrderedWithdraw</a></li><li><a href="abstracts_StakingBase.html#stakingEpoch">stakingEpoch</a></li><li><a href="abstracts_StakingBase.html#validatorSetContract">validatorSetContract</a></li><li><a href="abstracts_StakingBase.html#withdraw">withdraw</a></li></ul></div><div class="reference"><h2>Reference</h2><div class="events"><h3>Events</h3><ul><li><div class="item event"><span id="Claimed" class="anchor-marker"></span><h4 class="name">Claimed</h4><div class="body"><code class="signature">event <strong>Claimed</strong><span>(address fromPoolStakingAddress, address staker, uint256 stakingEpoch, uint256 amount) </span></code><hr/><div class="description"><p>Emitted by the `claimOrderedWithdraw` function to signal the staker withdrew the specified amount of requested tokens from the specified pool during the specified staking epoch.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>fromPoolStakingAddress</code> - The pool from which the `staker` withdrew the `amount`.</div><div><code>staker</code> - The address of the staker that withdrew the `amount`.</div><div><code>stakingEpoch</code> - The serial number of the staking epoch during which the claim was made.</div><div><code>amount</code> - The withdrawal amount.</div></dd></dl></div></div></li><li><div class="item event"><span id="StakeMoved" class="anchor-marker"></span><h4 class="name">StakeMoved</h4><div class="body"><code class="signature">event <strong>StakeMoved</strong><span>(address fromPoolStakingAddress, address toPoolStakingAddress, address staker, uint256 stakingEpoch, uint256 amount) </span></code><hr/><div class="description"><p>Emitted by the `moveStake` function to signal the staker moved the specified amount of stake from one pool to another during the specified staking epoch.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>fromPoolStakingAddress</code> - The pool from which the `staker` moved the stake.</div><div><code>toPoolStakingAddress</code> - The destination pool where the `staker` moved the stake.</div><div><code>staker</code> - The address of the staker who moved the `amount`.</div><div><code>stakingEpoch</code> - The serial number of the staking epoch during which the `amount` was moved.</div><div><code>amount</code> - The stake amount.</div></dd></dl></div></div></li><li><div class="item event"><span id="Staked" class="anchor-marker"></span><h4 class="name">Staked</h4><div class="body"><code class="signature">event <strong>Staked</strong><span>(address toPoolStakingAddress, address staker, uint256 stakingEpoch, uint256 amount) </span></code><hr/><div class="description"><p>Emitted by the `stake` function to signal the staker placed a stake of the specified amount for the specified pool during the specified staking epoch.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>toPoolStakingAddress</code> - The pool in which the `staker` placed the stake.</div><div><code>staker</code> - The address of the staker that placed the stake.</div><div><code>stakingEpoch</code> - The serial number of the staking epoch during which the stake was made.</div><div><code>amount</code> - The stake amount.</div></dd></dl></div></div></li><li><div class="item event"><span id="WithdrawalOrdered" class="anchor-marker"></span><h4 class="name">WithdrawalOrdered</h4><div class="body"><code class="signature">event <strong>WithdrawalOrdered</strong><span>(address fromPoolStakingAddress, address staker, uint256 stakingEpoch, int256 amount) </span></code><hr/><div class="description"><p>Emitted by the `orderWithdraw` function to signal the staker ordered the withdrawal of the specified amount of their stake from the specified pool during the specified staking epoch.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>fromPoolStakingAddress</code> - The pool from which the `staker` ordered a withdrawal of the `amount`.</div><div><code>staker</code> - The address of the staker that ordered the withdrawal of the `amount`.</div><div><code>stakingEpoch</code> - The serial number of the staking epoch during which the order was made.</div><div><code>amount</code> - The ordered withdrawal amount. Can be either positive or negative. See the `orderWithdraw` function.</div></dd></dl></div></div></li><li><div class="item event"><span id="Withdrawn" class="anchor-marker"></span><h4 class="name">Withdrawn</h4><div class="body"><code class="signature">event <strong>Withdrawn</strong><span>(address fromPoolStakingAddress, address staker, uint256 stakingEpoch, uint256 amount) </span></code><hr/><div class="description"><p>Emitted by the `withdraw` function to signal the staker withdrew the specified amount of a stake from the specified pool during the specified staking epoch.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>fromPoolStakingAddress</code> - The pool from which the `staker` withdrew the `amount`.</div><div><code>staker</code> - The address of staker that withdrew the `amount`.</div><div><code>stakingEpoch</code> - The serial number of the staking epoch during which the withdrawal was made.</div><div><code>amount</code> - The withdrawal amount.</div></dd></dl></div></div></li></ul></div><div class="modifiers"><h3>Modifiers</h3><ul><li><div class="item modifier"><span id="gasPriceIsValid" class="anchor-marker"></span><h4 class="name">gasPriceIsValid</h4><div class="body"><code class="signature">modifier <strong>gasPriceIsValid</strong><span>() </span></code><hr/><div class="description"><p>Ensures the transaction gas price is not zero.</p></div></div></div></li><li><div class="item modifier"><span id="onlyBlockRewardContract" class="anchor-marker"></span><h4 class="name">onlyBlockRewardContract</h4><div class="body"><code class="signature">modifier <strong>onlyBlockRewardContract</strong><span>() </span></code><hr/><div class="description"><p>Ensures the caller is the BlockReward contract address (EternalStorageProxy proxy contract for BlockReward).</p></div></div></div></li><li><div class="item modifier"><span id="onlyValidatorSetContract" class="anchor-marker"></span><h4 class="name">onlyValidatorSetContract</h4><div class="body"><code class="signature">modifier <strong>onlyValidatorSetContract</strong><span>() </span></code><hr/><div class="description"><p>Ensures the caller is the ValidatorSet contract address (EternalStorageProxy proxy contract for ValidatorSet).</p></div></div></div></li></ul></div><div class="functions"><h3>Functions</h3><ul><li><div class="item function"><span id="_addPoolActive" class="anchor-marker"></span><h4 class="name">_addPoolActive</h4><div class="body"><code class="signature">function <strong>_addPoolActive</strong><span>(address _stakingAddress, bool _toBeElected) </span><span>internal </span></code><hr/><div class="description"><p>Adds the specified staking address to the array of active pools returned by the `getPools` getter. Used by the `stake` and `orderWithdraw` functions.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_stakingAddress</code> - The pool added to the array of active pools.</div><div><code>_toBeElected</code> - The boolean flag which defines whether the specified address should be added simultaneously to the `poolsToBeElected` array. See the `getPoolsToBeElected` getter.</div></dd></dl></div></div></li><li><div class="item function"><span id="_addPoolDelegator" class="anchor-marker"></span><h4 class="name">_addPoolDelegator</h4><div class="body"><code class="signature">function <strong>_addPoolDelegator</strong><span>(address _poolStakingAddress, address _delegator) </span><span>internal </span></code><hr/><div class="description"><p>Adds the specified address to the array of the current active delegators of the specified pool. Used by the `stake` and `orderWithdraw` functions. See the `poolDelegators` getter.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The pool staking address.</div><div><code>_delegator</code> - The delegator&#x27;s address.</div></dd></dl></div></div></li><li><div class="item function"><span id="_addPoolDelegatorInactive" class="anchor-marker"></span><h4 class="name">_addPoolDelegatorInactive</h4><div class="body"><code class="signature">function <strong>_addPoolDelegatorInactive</strong><span>(address _poolStakingAddress, address _delegator) </span><span>internal </span></code><hr/><div class="description"><p>Adds the specified address to the array of the current inactive delegators of the specified pool. Used by the `_removePoolDelegator` function.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The pool staking address.</div><div><code>_delegator</code> - The delegator&#x27;s address.</div></dd></dl></div></div></li><li><div class="item function"><span id="_addPoolInactive" class="anchor-marker"></span><h4 class="name">_addPoolInactive</h4><div class="body"><code class="signature">function <strong>_addPoolInactive</strong><span>(address _stakingAddress) </span><span>internal </span></code><hr/><div class="description"><p>Adds the specified staking address to the array of inactive pools returned by the `getPoolsInactive` getter. Used by the `_removePool` function.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_stakingAddress</code> - The pool added to the array of inactive pools.</div></dd></dl></div></div></li><li><div class="item function"><span id="_addPoolToBeElected" class="anchor-marker"></span><h4 class="name">_addPoolToBeElected</h4><div class="body"><code class="signature">function <strong>_addPoolToBeElected</strong><span>(address _stakingAddress) </span><span>internal </span></code><hr/><div class="description"><p>Adds the specified staking address to the array of pools returned by the `getPoolsToBeElected` getter. Used by the `_addPoolActive` function. See the `getPoolsToBeElected` getter.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_stakingAddress</code> - The pool added to the `poolsToBeElected` array.</div></dd></dl></div></div></li><li><div class="item function"><span id="_addPoolToBeRemoved" class="anchor-marker"></span><h4 class="name">_addPoolToBeRemoved</h4><div class="body"><code class="signature">function <strong>_addPoolToBeRemoved</strong><span>(address _stakingAddress) </span><span>internal </span></code><hr/><div class="description"><p>Adds the specified staking address to the array of pools returned by the `getPoolsToBeRemoved` getter. Used by withdrawal functions. See the `getPoolsToBeRemoved` getter.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_stakingAddress</code> - The pool added to the `poolsToBeRemoved` array.</div></dd></dl></div></div></li><li><div class="item function"><span id="_deletePoolToBeElected" class="anchor-marker"></span><h4 class="name">_deletePoolToBeElected</h4><div class="body"><code class="signature">function <strong>_deletePoolToBeElected</strong><span>(address _stakingAddress) </span><span>internal </span></code><hr/><div class="description"><p>Deletes the specified staking address from the array of pools returned by the `getPoolsToBeElected` getter. Used by the `_addPoolToBeRemoved` and `_removePool` functions. See the `getPoolsToBeElected` getter.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_stakingAddress</code> - The pool deleted from the `poolsToBeElected` array.</div></dd></dl></div></div></li><li><div class="item function"><span id="_deletePoolToBeRemoved" class="anchor-marker"></span><h4 class="name">_deletePoolToBeRemoved</h4><div class="body"><code class="signature">function <strong>_deletePoolToBeRemoved</strong><span>(address _stakingAddress) </span><span>internal </span></code><hr/><div class="description"><p>Deletes the specified staking address from the array of pools returned by the `getPoolsToBeRemoved` getter. Used by the `_addPoolToBeElected` and `_removePool` functions. See the `getPoolsToBeRemoved` getter.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_stakingAddress</code> - The pool deleted from the `poolsToBeRemoved` array.</div></dd></dl></div></div></li><li><div class="item function"><span id="_getCurrentBlockNumber" class="anchor-marker"></span><h4 class="name">_getCurrentBlockNumber</h4><div class="body"><code class="signature">function <strong>_getCurrentBlockNumber</strong><span>() </span><span>internal </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the current block number. Needed mostly for unit tests.</p></div><dl><dt><span class="label-return">Returns:</span></dt><dd>uint256</dd></dl></div></div></li><li><div class="item function"><span id="_getMaxCandidates" class="anchor-marker"></span><h4 class="name">_getMaxCandidates</h4><div class="body"><code class="signature">function <strong>_getMaxCandidates</strong><span>() </span><span>internal </span><span>pure </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the max number of candidates (including validators). See the MAX_CANDIDATES constant. Needed mostly for unit tests.</p></div><dl><dt><span class="label-return">Returns:</span></dt><dd>uint256</dd></dl></div></div></li><li><div class="item function"><span id="_initialize" class="anchor-marker"></span><h4 class="name">_initialize</h4><div class="body"><code class="signature">function <strong>_initialize</strong><span>(address _validatorSetContract, address _erc20TokenContract, address[] _initialStakingAddresses, uint256 _delegatorMinStake, uint256 _candidateMinStake) </span><span>internal </span></code><hr/><div class="description"><p>Initializes the network parameters on the genesis block. Used by the `initialize` function of a child contract.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_validatorSetContract</code> - The address of the `ValidatorSet` contract.</div><div><code>_erc20TokenContract</code> - The address of the ERC20/677 staking token contract. Can be zero and defined later using the `setErc20TokenContract` function.</div><div><code>_initialStakingAddresses</code> - The array of initial validators&#x27; staking addresses.</div><div><code>_delegatorMinStake</code> - The minimum allowed amount of delegator stake in STAKE_UNITs.</div><div><code>_candidateMinStake</code> - The minimum allowed amount of candidate/validator stake in STAKE_UNITs.</div></dd></dl></div></div></li><li><div class="item function"><span id="_isPoolToBeElected" class="anchor-marker"></span><h4 class="name">_isPoolToBeElected</h4><div class="body"><code class="signature">function <strong>_isPoolToBeElected</strong><span>(address _stakingAddress) </span><span>internal </span><span>view </span><span>returns  (bool, uint256) </span></code><hr/><div class="description"><p>Determines if the specified pool is in the `poolsToBeElected` array. See the `getPoolsToBeElected` getter. Used by the `_setLikelihood` function.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_stakingAddress</code> - The staking address of the pool.</div></dd><dt><span class="label-return">Returns:</span></dt><dd>index The position of the item in the `poolsToBeElected` array if `toBeElected` is `true`.</dd></dl></div></div></li><li><div class="item function"><span id="_isWithdrawAllowed" class="anchor-marker"></span><h4 class="name">_isWithdrawAllowed</h4><div class="body"><code class="signature">function <strong>_isWithdrawAllowed</strong><span>(address _miningAddress) </span><span>internal </span><span>view </span><span>returns  (bool) </span></code><hr/><div class="description"><p>Returns `true` if withdrawal from the pool of the specified validator is allowed at the moment. Used by all withdrawal functions.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_miningAddress</code> - The mining address of the validator&#x27;s pool.</div></dd><dt><span class="label-return">Returns:</span></dt><dd>bool</dd></dl></div></div></li><li><div class="item function"><span id="_removePool" class="anchor-marker"></span><h4 class="name">_removePool</h4><div class="body"><code class="signature">function <strong>_removePool</strong><span>(address _stakingAddress) </span><span>internal </span></code><hr/><div class="description"><p>Removes the specified staking address from the array of active pools returned by the `getPools` getter. Used by the `removePool` and withdrawal functions.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_stakingAddress</code> - The pool removed from the array of active pools.</div></dd></dl></div></div></li><li><div class="item function"><span id="_removePoolDelegator" class="anchor-marker"></span><h4 class="name">_removePoolDelegator</h4><div class="body"><code class="signature">function <strong>_removePoolDelegator</strong><span>(address _poolStakingAddress, address _delegator) </span><span>internal </span></code><hr/><div class="description"><p>Removes the specified address from the array of the current active delegators of the specified pool. Used by the withdrawal functions. See the `poolDelegators` getter.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The pool staking address.</div><div><code>_delegator</code> - The delegator&#x27;s address.</div></dd></dl></div></div></li><li><div class="item function"><span id="_removePoolDelegatorInactive" class="anchor-marker"></span><h4 class="name">_removePoolDelegatorInactive</h4><div class="body"><code class="signature">function <strong>_removePoolDelegatorInactive</strong><span>(address _poolStakingAddress, address _delegator) </span><span>internal </span></code><hr/><div class="description"><p>Removes the specified address from the array of the inactive delegators of the specified pool. Used by the `_addPoolDelegator` and `_removePoolDelegator` functions.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The pool staking address.</div><div><code>_delegator</code> - The delegator&#x27;s address.</div></dd></dl></div></div></li><li><div class="item function"><span id="_removePoolInactive" class="anchor-marker"></span><h4 class="name">_removePoolInactive</h4><div class="body"><code class="signature">function <strong>_removePoolInactive</strong><span>(address _stakingAddress) </span><span>internal </span></code><hr/><div class="description"><p>Removes the specified staking address from the array of inactive pools returned by the `getPoolsInactive` getter. Used by the `_addPoolActive` and `_removePool` functions.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_stakingAddress</code> - The pool removed from the array of inactive pools.</div></dd></dl></div></div></li><li><div class="item function"><span id="_setCandidateMinStake" class="anchor-marker"></span><h4 class="name">_setCandidateMinStake</h4><div class="body"><code class="signature">function <strong>_setCandidateMinStake</strong><span>(uint256 _minStake) </span><span>internal </span></code><hr/><div class="description"><p>Sets (updates) the limit of the minimum candidate stake (CANDIDATE_MIN_STAKE). Used by the `_initialize` and `setCandidateMinStake` functions.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_minStake</code> - The value of a new limit in STAKE_UNITs.</div></dd></dl></div></div></li><li><div class="item function"><span id="_setDelegatorMinStake" class="anchor-marker"></span><h4 class="name">_setDelegatorMinStake</h4><div class="body"><code class="signature">function <strong>_setDelegatorMinStake</strong><span>(uint256 _minStake) </span><span>internal </span></code><hr/><div class="description"><p>Sets (updates) the limit of the minimum delegator stake (DELEGATOR_MIN_STAKE). Used by the `_initialize` and `setDelegatorMinStake` functions.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_minStake</code> - The value of a new limit in STAKE_UNITs.</div></dd></dl></div></div></li><li><div class="item function"><span id="_setLikelihood" class="anchor-marker"></span><h4 class="name">_setLikelihood</h4><div class="body"><code class="signature">function <strong>_setLikelihood</strong><span>(address _poolStakingAddress) </span><span>internal </span></code><hr/><div class="description"><p>Calculates (updates) the probability of being selected as a validator for the specified pool and updates the total sum of probability coefficients. See the `getPoolsLikelihood` getter. Used by the staking and withdrawal functions.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The address of the pool for which the probability coefficient must be updated.</div></dd></dl></div></div></li><li><div class="item function"><span id="_setOrderWithdrawEpoch" class="anchor-marker"></span><h4 class="name">_setOrderWithdrawEpoch</h4><div class="body"><code class="signature">function <strong>_setOrderWithdrawEpoch</strong><span>(address _poolStakingAddress, address _staker, uint256 _stakingEpoch) </span><span>internal </span></code><hr/><div class="description"><p>Sets the number of the staking epoch during which the specified staker ordered the latest withdraw from the specified pool. Used by the `orderWithdraw` function to allow the ordered amount to be claimed only in future staking epochs. See also the `orderWithdrawEpoch` getter.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The pool staking address from which the withdrawal will occur.</div><div><code>_staker</code> - The staker&#x27;s address that ordered the withdrawal.</div><div><code>_stakingEpoch</code> - The number of the current staking epoch.</div></dd></dl></div></div></li><li><div class="item function"><span id="_setOrderedWithdrawAmount" class="anchor-marker"></span><h4 class="name">_setOrderedWithdrawAmount</h4><div class="body"><code class="signature">function <strong>_setOrderedWithdrawAmount</strong><span>(address _poolStakingAddress, address _staker, uint256 _amount) </span><span>internal </span></code><hr/><div class="description"><p>Sets the current amount of staking tokens ordered for withdrawal from the specified pool by the specified staker. Used by the `orderWithdraw` and `claimOrderedWithdraw` functions.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The pool staking address from which the amount will be withdrawn.</div><div><code>_staker</code> - The staker&#x27;s address that ordered the withdrawal.</div><div><code>_amount</code> - The amount of staking tokens ordered for withdrawal.</div></dd></dl></div></div></li><li><div class="item function"><span id="_setOrderedWithdrawAmountTotal" class="anchor-marker"></span><h4 class="name">_setOrderedWithdrawAmountTotal</h4><div class="body"><code class="signature">function <strong>_setOrderedWithdrawAmountTotal</strong><span>(address _poolStakingAddress, uint256 _amount) </span><span>internal </span></code><hr/><div class="description"><p>Sets the total amount of staking tokens ordered for withdrawal from the specified pool by all its stakers.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The pool staking address from which the amount will be withdrawn.</div><div><code>_amount</code> - The total amount of staking tokens ordered for withdrawal.</div></dd></dl></div></div></li><li><div class="item function"><span id="_setPoolDelegatorInactiveIndex" class="anchor-marker"></span><h4 class="name">_setPoolDelegatorInactiveIndex</h4><div class="body"><code class="signature">function <strong>_setPoolDelegatorInactiveIndex</strong><span>(address _poolStakingAddress, address _delegator, uint256 _index) </span><span>internal </span></code><hr/><div class="description"><p>Sets the delegator&#x27;s index in the `poolDelegatorsInactive` array. Used by the `_addPoolDelegatorInactive` and `_removePoolDelegatorInactive` functions.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The pool staking address.</div><div><code>_delegator</code> - The delegator&#x27;s address.</div><div><code>_index</code> - The index of the delegator in the `poolDelegatorsInactive` array.</div></dd></dl></div></div></li><li><div class="item function"><span id="_setPoolDelegatorIndex" class="anchor-marker"></span><h4 class="name">_setPoolDelegatorIndex</h4><div class="body"><code class="signature">function <strong>_setPoolDelegatorIndex</strong><span>(address _poolStakingAddress, address _delegator, uint256 _index) </span><span>internal </span></code><hr/><div class="description"><p>Sets the delegator&#x27;s index in the array returned by the `poolDelegators` getter. Used by the `_addPoolDelegator` and `_removePoolDelegator` functions.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The pool staking address.</div><div><code>_delegator</code> - The delegator&#x27;s address.</div><div><code>_index</code> - The index of the delegator in the `poolDelegators` array.</div></dd></dl></div></div></li><li><div class="item function"><span id="_setPoolInactiveIndex" class="anchor-marker"></span><h4 class="name">_setPoolInactiveIndex</h4><div class="body"><code class="signature">function <strong>_setPoolInactiveIndex</strong><span>(address _stakingAddress, uint256 _index) </span><span>internal </span></code><hr/><div class="description"><p>Sets the index for the specified address which indicates the position of the address in the array returned by the `getPoolsInactive` getter. Used by the `_addPoolInactive` and `_removePoolInactive` functions.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_stakingAddress</code> - The pool staking address.</div><div><code>_index</code> - The index value.</div></dd></dl></div></div></li><li><div class="item function"><span id="_setPoolIndex" class="anchor-marker"></span><h4 class="name">_setPoolIndex</h4><div class="body"><code class="signature">function <strong>_setPoolIndex</strong><span>(address _stakingAddress, uint256 _index) </span><span>internal </span></code><hr/><div class="description"><p>Sets the index for the specified address which indicates the position of the address in the array returned by the `getPools` getter. Used by the `_addPoolActive` and `_removePool` functions.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_stakingAddress</code> - The pool staking address.</div><div><code>_index</code> - The index value.</div></dd></dl></div></div></li><li><div class="item function"><span id="_setPoolToBeElectedIndex" class="anchor-marker"></span><h4 class="name">_setPoolToBeElectedIndex</h4><div class="body"><code class="signature">function <strong>_setPoolToBeElectedIndex</strong><span>(address _stakingAddress, uint256 _index) </span><span>internal </span></code><hr/><div class="description"><p>Sets the index for the specified address which indicates the position of the address in the array returned by the `getPoolsToBeElected` getter. Used by the `_addPoolToBeElected` and `_deletePoolToBeElected` functions.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_stakingAddress</code> - The pool staking address.</div><div><code>_index</code> - The index value.</div></dd></dl></div></div></li><li><div class="item function"><span id="_setPoolToBeRemovedIndex" class="anchor-marker"></span><h4 class="name">_setPoolToBeRemovedIndex</h4><div class="body"><code class="signature">function <strong>_setPoolToBeRemovedIndex</strong><span>(address _stakingAddress, uint256 _index) </span><span>internal </span></code><hr/><div class="description"><p>Sets the index for the specified address which indicates the position of the address in the array returned by the `getPoolsToBeRemoved` getter. Used by the `_addPoolToBeRemoved` and `_deletePoolToBeRemoved` functions.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_stakingAddress</code> - The pool staking address.</div><div><code>_index</code> - The index value.</div></dd></dl></div></div></li><li><div class="item function"><span id="_setStakeAmount" class="anchor-marker"></span><h4 class="name">_setStakeAmount</h4><div class="body"><code class="signature">function <strong>_setStakeAmount</strong><span>(address _poolStakingAddress, address _staker, uint256 _amount) </span><span>internal </span></code><hr/><div class="description"><p>Sets the amount of staking tokens currently staked into the specified pool by the specified staker. Used by the `stake`, `withdraw`, and `claimOrderedWithdraw` functions. See the `stakeAmount` getter.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The pool staking address.</div><div><code>_staker</code> - The staker&#x27;s address.</div><div><code>_amount</code> - The amount of staking tokens.</div></dd></dl></div></div></li><li><div class="item function"><span id="_setStakeAmountByCurrentEpoch" class="anchor-marker"></span><h4 class="name">_setStakeAmountByCurrentEpoch</h4><div class="body"><code class="signature">function <strong>_setStakeAmountByCurrentEpoch</strong><span>(address _poolStakingAddress, address _staker, uint256 _amount) </span><span>internal </span></code><hr/><div class="description"><p>Sets the amount of staking tokens staked into the specified pool by the specified staker during the current staking epoch (see the `stakingEpoch` getter). See also the `stakeAmountByCurrentEpoch` getter. Used by the `_stake` and `_withdraw` functions.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The pool staking address.</div><div><code>_staker</code> - The staker&#x27;s address.</div><div><code>_amount</code> - The amount of staking tokens.</div></dd></dl></div></div></li><li><div class="item function"><span id="_setStakeAmountTotal" class="anchor-marker"></span><h4 class="name">_setStakeAmountTotal</h4><div class="body"><code class="signature">function <strong>_setStakeAmountTotal</strong><span>(address _poolStakingAddress, uint256 _amount) </span><span>internal </span></code><hr/><div class="description"><p>Sets the total amount of staking tokens currently staked into the specified pool.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The pool staking address.</div><div><code>_amount</code> - The total amount of staking tokens.</div></dd></dl></div></div></li><li><div class="item function"><span id="_stake" class="anchor-marker"></span><h4 class="name">_stake</h4><div class="body"><code class="signature">function <strong>_stake</strong><span>(address _poolStakingAddress, address _staker, uint256 _amount) </span><span>internal </span></code><hr/><div class="description"><p>The internal function used by the `_stake` and `moveStake` functions. See the `stake` public function for more details.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The staking address of the pool where the tokens should be staked.</div><div><code>_staker</code> - The staker&#x27;s address.</div><div><code>_amount</code> - The amount of tokens to be staked.</div></dd></dl></div></div></li><li><div class="item function"><span id="_stake" class="anchor-marker"></span><h4 class="name">_stake</h4><div class="body"><code class="signature">function <strong>_stake</strong><span>(address _toPoolStakingAddress, uint256 _amount) </span><span>internal </span></code><hr/><div class="description"><p>The internal function used by the `stake` and `addPool` functions. See the `stake` public function for more details.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_toPoolStakingAddress</code> - The staking address of the pool where the tokens should be staked.</div><div><code>_amount</code> - The amount of tokens to be staked.</div></dd></dl></div></div></li><li><div class="item function"><span id="_withdraw" class="anchor-marker"></span><h4 class="name">_withdraw</h4><div class="body"><code class="signature">function <strong>_withdraw</strong><span>(address _poolStakingAddress, address _staker, uint256 _amount) </span><span>internal </span></code><hr/><div class="description"><p>The internal function used by the `withdraw` and `moveStake` functions. See the `withdraw` public function for more details.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The staking address of the pool from which the tokens should be withdrawn.</div><div><code>_staker</code> - The staker&#x27;s address.</div><div><code>_amount</code> - The amount of the tokens to be withdrawn.</div></dd></dl></div></div></li><li><div class="item function"><span id="_withdrawCheckPool" class="anchor-marker"></span><h4 class="name">_withdrawCheckPool</h4><div class="body"><code class="signature">function <strong>_withdrawCheckPool</strong><span>(address _poolStakingAddress, address _staker) </span><span>internal </span></code><hr/><div class="description"><p>The internal function used by the `_withdraw` and `claimOrderedWithdraw` functions. Contains a common logic for these functions.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The staking address of the pool from which the tokens are withdrawn.</div><div><code>_staker</code> - The staker&#x27;s address.</div></dd></dl></div></div></li><li><div class="item function"><span id="areStakeAndWithdrawAllowed" class="anchor-marker"></span><h4 class="name">areStakeAndWithdrawAllowed</h4><div class="body"><code class="signature"><span>abstract </span>function <strong>areStakeAndWithdrawAllowed</strong><span>() </span><span>public </span><span>view </span><span>returns  (bool) </span></code><hr/><div class="description"><p>Returns a boolean flag indicating whether the stake and withdraw operations are allowed at the moment.</p></div><dl><dt><span class="label-return">Returns:</span></dt><dd>bool</dd></dl></div></div></li><li><div class="item function"><span id="claimOrderedWithdraw" class="anchor-marker"></span><h4 class="name">claimOrderedWithdraw</h4><div class="body"><code class="signature">function <strong>claimOrderedWithdraw</strong><span>(address _poolStakingAddress) </span><span>external </span></code><hr/><div class="description"><p>Withdraws the staking tokens from the specified pool ordered during the previous staking epochs with the `orderWithdraw` function. The ordered amount can be retrieved by the `orderedWithdrawAmount` getter.</p></div><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="abstracts_StakingBase.html#gasPriceIsValid">gasPriceIsValid </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The staking address of the pool from which the ordered tokens are withdrawn.</div></dd></dl></div></div></li><li><div class="item function"><span id="clearUnremovableValidator" class="anchor-marker"></span><h4 class="name">clearUnremovableValidator</h4><div class="body"><code class="signature">function <strong>clearUnremovableValidator</strong><span>(address _unremovableStakingAddress) </span><span>external </span></code><hr/><div class="description"><p>Adds the `unremovable validator` to either the `poolsToBeElected` or the `poolsToBeRemoved` array depending on their own stake in their own pool when they become removable. This allows the `ValidatorSet._newValidatorSet` function to recognize the unremovable validator as a regular removable pool. Called by the `ValidatorSet.clearUnremovableValidator` function.</p></div><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="abstracts_StakingBase.html#onlyValidatorSetContract">onlyValidatorSetContract </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_unremovableStakingAddress</code> - The staking address of the unremovable validator.</div></dd></dl></div></div></li><li><div class="item function"><span id="erc20TokenContract" class="anchor-marker"></span><h4 class="name">erc20TokenContract</h4><div class="body"><code class="signature">function <strong>erc20TokenContract</strong><span>() </span><span>public </span><span>view </span><span>returns  (address) </span></code><hr/><div class="description"><p>Returns the address of the ERC20/677 staking token contract.</p></div><dl><dt><span class="label-return">Returns:</span></dt><dd>address</dd></dl></div></div></li><li><div class="item function"><span id="getCandidateMinStake" class="anchor-marker"></span><h4 class="name">getCandidateMinStake</h4><div class="body"><code class="signature">function <strong>getCandidateMinStake</strong><span>() </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the limit of the minimum candidate stake (CANDIDATE_MIN_STAKE).</p></div><dl><dt><span class="label-return">Returns:</span></dt><dd>uint256</dd></dl></div></div></li><li><div class="item function"><span id="getDelegatorMinStake" class="anchor-marker"></span><h4 class="name">getDelegatorMinStake</h4><div class="body"><code class="signature">function <strong>getDelegatorMinStake</strong><span>() </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the limit of the minimum delegator stake (DELEGATOR_MIN_STAKE).</p></div><dl><dt><span class="label-return">Returns:</span></dt><dd>uint256</dd></dl></div></div></li><li><div class="item function"><span id="getPools" class="anchor-marker"></span><h4 class="name">getPools</h4><div class="body"><code class="signature">function <strong>getPools</strong><span>() </span><span>external </span><span>view </span><span>returns  (address[]) </span></code><hr/><div class="description"><p>Returns an array of the current active pools (the staking addresses of candidates and validators). The size of the array cannot exceed MAX_CANDIDATES. A pool can be added to this array with the `_addPoolActive` function which is called by the `stake` or `orderWithdraw` function. A pool is considered active if its address has at least the minimum stake and this stake is not ordered to be withdrawn.</p></div><dl><dt><span class="label-return">Returns:</span></dt><dd>address[]</dd></dl></div></div></li><li><div class="item function"><span id="getPoolsInactive" class="anchor-marker"></span><h4 class="name">getPoolsInactive</h4><div class="body"><code class="signature">function <strong>getPoolsInactive</strong><span>() </span><span>external </span><span>view </span><span>returns  (address[]) </span></code><hr/><div class="description"><p>Returns an array of the current inactive pools (the staking addresses of former candidates). A pool can be added to this array with the `_addPoolInactive` function which is called by `_removePool`. A pool is considered inactive if it is banned for some reason, if its address has zero stake, or if its entire stake is ordered to be withdrawn.</p></div><dl><dt><span class="label-return">Returns:</span></dt><dd>address[]</dd></dl></div></div></li><li><div class="item function"><span id="getPoolsLikelihood" class="anchor-marker"></span><h4 class="name">getPoolsLikelihood</h4><div class="body"><code class="signature">function <strong>getPoolsLikelihood</strong><span>() </span><span>external </span><span>view </span><span>returns  (int256[], int256) </span></code><hr/><div class="description"><p>Returns the list of probability coefficients of being selected as a validator for each corresponding address in the `poolsToBeElected` array (see the `getPoolsToBeElected` getter) and a sum of these coefficients. Used by the `ValidatorSet._newValidatorSet` function when randomly selecting new validators at the last block of a staking epoch. A pool&#x27;s coefficient is updated every time any staked amount is changed in this pool (see the `_setLikelihood` function).</p></div><dl><dt><span class="label-return">Returns:</span></dt><dd>sum The sum of the coefficients.</dd></dl></div></div></li><li><div class="item function"><span id="getPoolsToBeElected" class="anchor-marker"></span><h4 class="name">getPoolsToBeElected</h4><div class="body"><code class="signature">function <strong>getPoolsToBeElected</strong><span>() </span><span>external </span><span>view </span><span>returns  (address[]) </span></code><hr/><div class="description"><p>Returns the list of pools (their staking addresses) which will participate in a new validator set selection process in the `ValidatorSet._newValidatorSet` function. This is an array of pools which will be considered as candidates when forming a new validator set (at the last block of a staking epoch). This array is kept updated by the `_addPoolToBeElected` and `_deletePoolToBeElected` functions.</p></div><dl><dt><span class="label-return">Returns:</span></dt><dd>address[]</dd></dl></div></div></li><li><div class="item function"><span id="getPoolsToBeRemoved" class="anchor-marker"></span><h4 class="name">getPoolsToBeRemoved</h4><div class="body"><code class="signature">function <strong>getPoolsToBeRemoved</strong><span>() </span><span>external </span><span>view </span><span>returns  (address[]) </span></code><hr/><div class="description"><p>Returns the list of pools (their staking addresses) which will be removed by the `ValidatorSet._newValidatorSet` function from the active `pools` array (at the last block of a staking epoch). This array is kept updated by the `_addPoolToBeRemoved` and `_deletePoolToBeRemoved` functions. A pool is added to this array when the pool&#x27;s address withdraws all of its own staking tokens from the pool, inactivating the pool.</p></div><dl><dt><span class="label-return">Returns:</span></dt><dd>address[]</dd></dl></div></div></li><li><div class="item function"><span id="incrementStakingEpoch" class="anchor-marker"></span><h4 class="name">incrementStakingEpoch</h4><div class="body"><code class="signature">function <strong>incrementStakingEpoch</strong><span>() </span><span>external </span></code><hr/><div class="description"><p>Increments the serial number of the current staking epoch. Called by the `ValidatorSet._newValidatorSet` at the last block of the finished staking epoch.</p></div><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="abstracts_StakingBase.html#onlyValidatorSetContract">onlyValidatorSetContract </a></dd></dl></div></div></li><li><div class="item function"><span id="isPoolActive" class="anchor-marker"></span><h4 class="name">isPoolActive</h4><div class="body"><code class="signature">function <strong>isPoolActive</strong><span>(address _stakingAddress) </span><span>public </span><span>view </span><span>returns  (bool) </span></code><hr/><div class="description"><p>Returns a flag indicating whether a specified address is in the `pools` array. See the `getPools` getter.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_stakingAddress</code> - The staking address of the pool.</div></dd><dt><span class="label-return">Returns:</span></dt><dd>bool</dd></dl></div></div></li><li><div class="item function"><span id="maxWithdrawAllowed" class="anchor-marker"></span><h4 class="name">maxWithdrawAllowed</h4><div class="body"><code class="signature">function <strong>maxWithdrawAllowed</strong><span>(address _poolStakingAddress, address _staker) </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the maximum amount which can be withdrawn from the specified pool by the specified staker at the moment. Used by the `withdraw` function.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The pool staking address from which the withdrawal will be made.</div><div><code>_staker</code> - The staker address that is going to withdraw.</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint256</dd></dl></div></div></li><li><div class="item function"><span id="maxWithdrawOrderAllowed" class="anchor-marker"></span><h4 class="name">maxWithdrawOrderAllowed</h4><div class="body"><code class="signature">function <strong>maxWithdrawOrderAllowed</strong><span>(address _poolStakingAddress, address _staker) </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the maximum amount which can be ordered to be withdrawn from the specified pool by the specified staker at the moment. Used by the `orderWithdraw` function.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The pool staking address from which the withdrawal will be ordered.</div><div><code>_staker</code> - The staker address that is going to order the withdrawal.</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint256</dd></dl></div></div></li><li><div class="item function"><span id="moveStake" class="anchor-marker"></span><h4 class="name">moveStake</h4><div class="body"><code class="signature">function <strong>moveStake</strong><span>(address _fromPoolStakingAddress, address _toPoolStakingAddress, uint256 _amount) </span><span>external </span></code><hr/><div class="description"><p>Moves staking tokens from one pool to another. A staker calls this function when they want to move their tokens from one pool to another without withdrawing their tokens.</p></div><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="abstracts_StakingBase.html#gasPriceIsValid">gasPriceIsValid </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_fromPoolStakingAddress</code> - The staking address of the source pool.</div><div><code>_toPoolStakingAddress</code> - The staking address of the target pool.</div><div><code>_amount</code> - The amount of staking tokens to be moved. The amount cannot exceed the value returned by the `maxWithdrawAllowed` getter.</div></dd></dl></div></div></li><li><div class="item function"><span id="onTokenTransfer" class="anchor-marker"></span><h4 class="name">onTokenTransfer</h4><div class="body"><code class="signature">function <strong>onTokenTransfer</strong><span>(address , uint256 , bytes ) </span><span>public </span><span>pure </span><span>returns  (bool) </span></code><hr/><div class="description"><p>Prevents sending tokens directly to the `Staking` contract address by the `ERC677BridgeTokenRewardable.transferAndCall` function.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code></code> - address</div><div><code></code> - uint256</div><div><code></code> - bytes</div></dd><dt><span class="label-return">Returns:</span></dt><dd>bool</dd></dl></div></div></li><li><div class="item function"><span id="orderWithdraw" class="anchor-marker"></span><h4 class="name">orderWithdraw</h4><div class="body"><code class="signature">function <strong>orderWithdraw</strong><span>(address _poolStakingAddress, int256 _amount) </span><span>external </span></code><hr/><div class="description"><p>Orders a token withdrawal from the staking address of the specified pool to the staker&#x27;s address. The requested tokens can be claimed after the current staking epoch is complete using the `claimOrderedWithdraw` function.</p></div><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="abstracts_StakingBase.html#gasPriceIsValid">gasPriceIsValid </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The staking address of the pool from which the amount will be withdrawn.</div><div><code>_amount</code> - The amount to be withdrawn. A positive value means the staker wants to either set or increase their withdrawal amount. A negative value means the staker wants to decrease a withdrawal amount that was previously set. The amount cannot exceed the value returned by the `maxWithdrawOrderAllowed` getter.</div></dd></dl></div></div></li><li><div class="item function"><span id="orderWithdrawEpoch" class="anchor-marker"></span><h4 class="name">orderWithdrawEpoch</h4><div class="body"><code class="signature">function <strong>orderWithdrawEpoch</strong><span>(address _poolStakingAddress, address _staker) </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the number of the staking epoch during which the specified staker ordered the latest withdraw from the specified pool. Used by the `claimOrderedWithdraw` function to allow the ordered amount to be claimed only in future staking epochs.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The pool staking address from which the withdrawal will occur.</div><div><code>_staker</code> - The staker address that ordered the withdrawal.</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint256</dd></dl></div></div></li><li><div class="item function"><span id="orderedWithdrawAmount" class="anchor-marker"></span><h4 class="name">orderedWithdrawAmount</h4><div class="body"><code class="signature">function <strong>orderedWithdrawAmount</strong><span>(address _poolStakingAddress, address _staker) </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the current amount of staking tokens ordered for withdrawal from the specified pool by the specified staker. Used by the `orderWithdraw` and `claimOrderedWithdraw` functions.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The pool staking address from which the amount will be withdrawn.</div><div><code>_staker</code> - The staker address that ordered the withdrawal.</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint256</dd></dl></div></div></li><li><div class="item function"><span id="orderedWithdrawAmountTotal" class="anchor-marker"></span><h4 class="name">orderedWithdrawAmountTotal</h4><div class="body"><code class="signature">function <strong>orderedWithdrawAmountTotal</strong><span>(address _poolStakingAddress) </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the current total amount of staking tokens ordered for withdrawal from the specified pool by all of its stakers.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The pool staking address from which the amount will be withdrawn.</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint256</dd></dl></div></div></li><li><div class="item function"><span id="poolDelegatorInactiveIndex" class="anchor-marker"></span><h4 class="name">poolDelegatorInactiveIndex</h4><div class="body"><code class="signature">function <strong>poolDelegatorInactiveIndex</strong><span>(address _poolStakingAddress, address _delegator) </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the delegator&#x27;s index in the `poolDelegatorsInactive` array. Used by the `_removePoolDelegatorInactive` function. A delegator is considered inactive if they have withdrawn all their tokens from the specified pool or their entire stake is ordered to be withdrawn.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The pool staking address for which the inactive delegator&#x27;s index is returned.</div><div><code>_delegator</code> - The delegator address.</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint256</dd></dl></div></div></li><li><div class="item function"><span id="poolDelegatorIndex" class="anchor-marker"></span><h4 class="name">poolDelegatorIndex</h4><div class="body"><code class="signature">function <strong>poolDelegatorIndex</strong><span>(address _poolStakingAddress, address _delegator) </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the delegator&#x27;s index in the array returned by the `poolDelegators` getter. Used by the `_removePoolDelegator` function.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The pool staking address.</div><div><code>_delegator</code> - The delegator&#x27;s address.</div></dd><dt><span class="label-return">Returns:</span></dt><dd>If the returned value is zero, it may mean the array doesn&#x27;t contain the delegator. Check if the delegator is in the array using the `poolDelegators` getter.</dd></dl></div></div></li><li><div class="item function"><span id="poolDelegators" class="anchor-marker"></span><h4 class="name">poolDelegators</h4><div class="body"><code class="signature">function <strong>poolDelegators</strong><span>(address _poolStakingAddress) </span><span>public </span><span>view </span><span>returns  (address[]) </span></code><hr/><div class="description"><p>Returns an array of the current active delegators of the specified pool. A delegator is considered active if they have staked into the specified pool and their stake is not ordered to be withdrawn.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The pool staking address.</div></dd><dt><span class="label-return">Returns:</span></dt><dd>address[]</dd></dl></div></div></li><li><div class="item function"><span id="poolInactiveIndex" class="anchor-marker"></span><h4 class="name">poolInactiveIndex</h4><div class="body"><code class="signature">function <strong>poolInactiveIndex</strong><span>(address _stakingAddress) </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the pool&#x27;s index in the array returned by the `getPoolsInactive` getter. Used by the `_removePoolInactive` function.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_stakingAddress</code> - The pool staking address.</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint256</dd></dl></div></div></li><li><div class="item function"><span id="poolIndex" class="anchor-marker"></span><h4 class="name">poolIndex</h4><div class="body"><code class="signature">function <strong>poolIndex</strong><span>(address _stakingAddress) </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the pool&#x27;s index in the array returned by the `getPools` getter. Used by the `_removePool` function.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_stakingAddress</code> - The pool staking address.</div></dd><dt><span class="label-return">Returns:</span></dt><dd>If the returned value is zero, it may mean the array doesn&#x27;t contain the address. Check the address is in the array using the `isPoolActive` getter.</dd></dl></div></div></li><li><div class="item function"><span id="poolToBeElectedIndex" class="anchor-marker"></span><h4 class="name">poolToBeElectedIndex</h4><div class="body"><code class="signature">function <strong>poolToBeElectedIndex</strong><span>(address _stakingAddress) </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the pool&#x27;s index in the array returned by the `getPoolsToBeElected` getter. Used by the `_deletePoolToBeElected` and `_isPoolToBeElected` functions.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_stakingAddress</code> - The pool staking address.</div></dd><dt><span class="label-return">Returns:</span></dt><dd>If the returned value is zero, it may mean the array doesn&#x27;t contain the address. Check the address is in the array using the `getPoolsToBeElected` getter.</dd></dl></div></div></li><li><div class="item function"><span id="poolToBeRemovedIndex" class="anchor-marker"></span><h4 class="name">poolToBeRemovedIndex</h4><div class="body"><code class="signature">function <strong>poolToBeRemovedIndex</strong><span>(address _stakingAddress) </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the pool&#x27;s index in the array returned by the `getPoolsToBeRemoved` getter. Used by the `_deletePoolToBeRemoved` function.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_stakingAddress</code> - The pool staking address.</div></dd><dt><span class="label-return">Returns:</span></dt><dd>If the returned value is zero, it may mean the array doesn&#x27;t contain the address. Check the address is in the array using the `getPoolsToBeRemoved` getter.</dd></dl></div></div></li><li><div class="item function"><span id="removePool" class="anchor-marker"></span><h4 class="name">removePool</h4><div class="body"><code class="signature">function <strong>removePool</strong><span>(address _stakingAddress) </span><span>external </span></code><hr/><div class="description"><p>Removes a specified pool from the `pools` array (a list of active pools which can be retrieved by the `getPools` getter). Called by the `ValidatorSet._removeMaliciousValidator` or the `ValidatorSet._newValidatorSet` function when a pool must be removed by the algorithm.</p></div><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="abstracts_StakingBase.html#onlyValidatorSetContract">onlyValidatorSetContract </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_stakingAddress</code> - The staking address of the pool to be removed.</div></dd></dl></div></div></li><li><div class="item function"><span id="removePool" class="anchor-marker"></span><h4 class="name">removePool</h4><div class="body"><code class="signature">function <strong>removePool</strong><span>() </span><span>external </span></code><hr/><div class="description"><p>Removes the candidate&#x27;s or validator&#x27;s pool from the `pools` array (a list of active pools which can be retrieved by the `getPools` getter). When a candidate or validator wants to remove their pool, they should call this function from their staking address. A validator cannot remove their pool while they are an `unremovable validator`.</p></div><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="abstracts_StakingBase.html#gasPriceIsValid">gasPriceIsValid </a></dd></dl></div></div></li><li><div class="item function"><span id="setCandidateMinStake" class="anchor-marker"></span><h4 class="name">setCandidateMinStake</h4><div class="body"><code class="signature">function <strong>setCandidateMinStake</strong><span>(uint256 _minStake) </span><span>external </span></code><hr/><div class="description"><p>Sets (updates) the limit of the minimum candidate stake (CANDIDATE_MIN_STAKE). Can only be called by the `owner`.</p></div><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="eternal-storage_OwnedEternalStorage.html#onlyOwner">onlyOwner </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_minStake</code> - The value of a new limit in STAKE_UNITs.</div></dd></dl></div></div></li><li><div class="item function"><span id="setDelegatorMinStake" class="anchor-marker"></span><h4 class="name">setDelegatorMinStake</h4><div class="body"><code class="signature">function <strong>setDelegatorMinStake</strong><span>(uint256 _minStake) </span><span>external </span></code><hr/><div class="description"><p>Sets (updates) the limit of minimum delegator stake (DELEGATOR_MIN_STAKE). Can only be called by the `owner`.</p></div><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="eternal-storage_OwnedEternalStorage.html#onlyOwner">onlyOwner </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_minStake</code> - The value of a new limit in STAKE_UNITs.</div></dd></dl></div></div></li><li><div class="item function"><span id="setErc20TokenContract" class="anchor-marker"></span><h4 class="name">setErc20TokenContract</h4><div class="body"><code class="signature">function <strong>setErc20TokenContract</strong><span>(address _erc20TokenContract) </span><span>external </span></code><hr/><div class="description"><p>Sets (updates) the address of the ERC20/ERC677 staking token contract. Can only be called by the `owner`.</p></div><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="eternal-storage_OwnedEternalStorage.html#onlyOwner">onlyOwner </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_erc20TokenContract</code> - The address of the contract.</div></dd></dl></div></div></li><li><div class="item function"><span id="stake" class="anchor-marker"></span><h4 class="name">stake</h4><div class="body"><code class="signature">function <strong>stake</strong><span>(address _toPoolStakingAddress, uint256 _amount) </span><span>external </span></code><hr/><div class="description"><p>Moves the specified amount of staking tokens from the staker&#x27;s address to the staking address of the specified pool. A staker calls this function when they want to make a stake into a pool.</p></div><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="abstracts_StakingBase.html#gasPriceIsValid">gasPriceIsValid </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_toPoolStakingAddress</code> - The staking address of the pool where the tokens should be staked.</div><div><code>_amount</code> - The amount of tokens to be staked.</div></dd></dl></div></div></li><li><div class="item function"><span id="stakeAmount" class="anchor-marker"></span><h4 class="name">stakeAmount</h4><div class="body"><code class="signature">function <strong>stakeAmount</strong><span>(address _poolStakingAddress, address _staker) </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the amount of staking tokens currently staked into the specified pool by the specified staker. Doesn&#x27;t take into account the ordered amount to be withdrawn (use the `stakeAmountMinusOrderedWithdraw` instead).</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The pool staking address.</div><div><code>_staker</code> - The staker&#x27;s address.</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint256</dd></dl></div></div></li><li><div class="item function"><span id="stakeAmountByCurrentEpoch" class="anchor-marker"></span><h4 class="name">stakeAmountByCurrentEpoch</h4><div class="body"><code class="signature">function <strong>stakeAmountByCurrentEpoch</strong><span>(address _poolStakingAddress, address _staker) </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the amount of staking tokens staked into the specified pool by the specified staker during the current staking epoch (see the `stakingEpoch` getter). Used by the `stake`, `withdraw`, and `orderWithdraw` functions.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The pool staking address.</div><div><code>_staker</code> - The staker&#x27;s address.</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint256</dd></dl></div></div></li><li><div class="item function"><span id="stakeAmountMinusOrderedWithdraw" class="anchor-marker"></span><h4 class="name">stakeAmountMinusOrderedWithdraw</h4><div class="body"><code class="signature">function <strong>stakeAmountMinusOrderedWithdraw</strong><span>(address _poolStakingAddress, address _staker) </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the amount of staking tokens currently staked into the specified pool by the specified staker taking into account the ordered amount to be withdrawn. See also the `stakeAmount` and `orderedWithdrawAmount`.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The pool staking address.</div><div><code>_staker</code> - The staker&#x27;s address.</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint256</dd></dl></div></div></li><li><div class="item function"><span id="stakeAmountTotal" class="anchor-marker"></span><h4 class="name">stakeAmountTotal</h4><div class="body"><code class="signature">function <strong>stakeAmountTotal</strong><span>(address _poolStakingAddress) </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the total amount of staking tokens currently staked into the specified pool. Doesn&#x27;t take into account the ordered amounts to be withdrawn (use the `stakeAmountTotalMinusOrderedWithdraw` instead).</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The pool staking address.</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint256</dd></dl></div></div></li><li><div class="item function"><span id="stakeAmountTotalMinusOrderedWithdraw" class="anchor-marker"></span><h4 class="name">stakeAmountTotalMinusOrderedWithdraw</h4><div class="body"><code class="signature">function <strong>stakeAmountTotalMinusOrderedWithdraw</strong><span>(address _poolStakingAddress) </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the total amount of staking tokens currently staked into the specified pool taking into account the ordered amounts to be withdrawn. See also the `stakeAmountTotal` and `orderedWithdrawAmountTotal` getters.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_poolStakingAddress</code> - The pool staking address.</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint256</dd></dl></div></div></li><li><div class="item function"><span id="stakingEpoch" class="anchor-marker"></span><h4 class="name">stakingEpoch</h4><div class="body"><code class="signature">function <strong>stakingEpoch</strong><span>() </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Returns the serial number of the current staking epoch.</p></div><dl><dt><span class="label-return">Returns:</span></dt><dd>uint256</dd></dl></div></div></li><li><div class="item function"><span id="validatorSetContract" class="anchor-marker"></span><h4 class="name">validatorSetContract</h4><div class="body"><code class="signature">function <strong>validatorSetContract</strong><span>() </span><span>public </span><span>view </span><span>returns  (IValidatorSet) </span></code><hr/><div class="description"><p>Returns the address of the `ValidatorSet` contract.</p></div><dl><dt><span class="label-return">Returns:</span></dt><dd>IValidatorSet</dd></dl></div></div></li><li><div class="item function"><span id="withdraw" class="anchor-marker"></span><h4 class="name">withdraw</h4><div class="body"><code class="signature">function <strong>withdraw</strong><span>(address _fromPoolStakingAddress, uint256 _amount) </span><span>external </span></code><hr/><div class="description"><p>Moves the specified amount of staking tokens from the staking address of the specified pool to the staker&#x27;s address. A staker calls this function when they want to withdraw their tokens.</p></div><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="abstracts_StakingBase.html#gasPriceIsValid">gasPriceIsValid </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_fromPoolStakingAddress</code> - The staking address of the pool from which the tokens should be withdrawn.</div><div><code>_amount</code> - The amount of tokens to be withdrawn. The amount cannot exceed the value returned by the `maxWithdrawAllowed` getter.</div></dd></dl></div></div></li></ul></div></div></div>
